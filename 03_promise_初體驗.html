<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>03_promise_初體驗</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
</head>
<body>
  <div class="container">
    <h2 class="page-header">Promise 初體驗</h2>
    <button class="btn btn-primary" type="button" id="btn">點擊抽獎</button>
  </div>
  <script>
    // 生成隨機數
    function random(min, max) {
      return Math.floor(Math.random() * (max - min + 1)) + min -1;
    }

    // 獲取元素對象
    const btn = document.querySelector('#btn');
    // 綁定點擊事件
    btn.addEventListener('click', function () {
      // // 定時器
      // setTimeout(() => {
      //   // 30% 中獎 1 - 100
      //   // 獲取隨機數 1 - 100
      //   let num = random(1, 100);
      //   // 判斷是否中獎
      //   if (num <= 30) {
      //     alert('恭喜中獎！');
      //   } else {
      //     alert('未中獎，再接再厲');
      //   }
      // }, 1000);

      // Promise 形式實現
      // 兩個參數通常會寫 
      // resolve 解決 函數類型的數據
      // reject 拒絕 函數類型的數據
      const p = new Promise((resolve, reject) => {
        setTimeout(() => {
          // 30% 中獎 1 - 100
          // 獲取隨機數 1 - 100
          let num = random(1, 100);
          // 判斷是否中獎
          if (num <= 30) {
            resolve(); // 將 Promise 狀態設置為「成功」
          } else {
            reject(); // 將 Promise 狀態設置為「失敗」
          }
        }, 1000);
        // 30% 中獎 1 - 100
        // 獲取隨機數 1 - 100
        let num = random(1, 100);
      })

      // 調用 then 方法
      console.log('p', p);
      p.then(() => {
        alert('恭喜中獎！');
      }).catch(() => {
        alert('未中獎，再接再厲');
      })

    });
    /*
    需求：
    點擊按鈕, 1秒後隨機抽獎(機率 30% 中獎)
    若中獎, 顯示中獎訊息
    若未中獎, 顯示未中獎訊息
    */

  </script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
</body>
</html>